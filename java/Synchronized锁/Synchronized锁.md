

#### Syncronized的三种应用方式

- ***修饰实例方法***

  ```java
  作用于当前实例加锁，进入同步代码前要获得当前实例的锁
  ```

- ***修饰静态方法***

  ```java
  作用于当前类对象(Class对象，每个类都有一个Class对象)，进入同步代码前要获得当前类对象（Class对象）的锁
  ```

- ***修饰代码块***

  ```java
  指定加锁对象，对给定对象加锁，进入同步代码库前要获得给定对象的锁。
  ```

#### java对象头

HotSpot虚拟机中，对象在内存中存储的布局可以分为三块区域：**对象头（Header）、实例数据（Instance Data）和对齐填充（Padding）**。

普通对象的对象头包括两部分：**Mark Word 和 Class Metadata Address （类型指针）**，如果是数组对象还包括一个额外的Array length数组长度部分。

***Mark Word***：用于存储对象自身的运行时数据，如哈希码（HashCode）、GC分代年龄、锁状态标志、线程持有的锁、偏向线程ID、偏向时间戳等等，占用内存大小与虚拟机位长一致。

***Class Metadata Address***：类型指针指向对象的类元数据，虚拟机通过这个指针确定该对象是哪个类的实例。

***Array length***：数组长度。

如果对象是数组类型，则虚拟机用3个Word（字宽）存储对象头，如果对象是非数组类型，则用2字宽存储对象头。在32位虚拟机中，一字宽等于四字节，即32bit。

![](.\img\img1.jpg)

#### 锁的类型

**可重入锁**：所谓重入锁，指的是以线程为单位，**当一个线程获取对象锁之后，这个线程可以再次获取本对象上的锁（而不需要重新竞争），**而其他的线程是不可以的，synchronized和ReentrantLock都是可重入锁。

